<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>时区测试</title>
</head>
<body>
    <h1>时区测试</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        
        // 测试不同格式的时间字符串
        const testCases = [
            '2024-12-31T23:59:59Z',           // UTC 时间（带 Z）
            '2024-12-31T23:59:59+00:00',      // UTC 时间（带 +00:00）
            '2024-12-31T23:59:59+08:00',      // 北京时间（带 +08:00）
            '2024-12-31T23:59:59',            // 无时区信息（会被视为本地时间）
            '2024-12-31 23:59:59',            // 空格分隔（会被视为本地时间）
        ];

        output.innerHTML += '<h2>当前本地时间：</h2>';
        output.innerHTML += `<p>${new Date().toString()}</p>`;
        output.innerHTML += `<p>时区偏移：${new Date().getTimezoneOffset()} 分钟</p>`;
        
        output.innerHTML += '<h2>测试结果：</h2>';
        
        testCases.forEach(dateStr => {
            const date = new Date(dateStr);
            output.innerHTML += `<h3>输入: ${dateStr}</h3>`;
            output.innerHTML += `<p>解析结果: ${date.toString()}</p>`;
            output.innerHTML += `<p>ISO 格式: ${date.toISOString()}</p>`;
            output.innerHTML += `<p>本地格式: ${date.toLocaleString('zh-CN')}</p>`;
            output.innerHTML += `<p>时间戳: ${date.getTime()}</p>`;
            output.innerHTML += '<hr>';
        });

        // 测试 augment-token-mng-1.2.0 的格式化方法
        output.innerHTML += '<h2>augment-token-mng-1.2.0 格式化方法：</h2>';
        const formatExpiryDate_v1 = (dateString) => {
            try {
                const date = new Date(dateString);
                return date.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch {
                return dateString;
            }
        };

        testCases.forEach(dateStr => {
            output.innerHTML += `<p>${dateStr} → ${formatExpiryDate_v1(dateStr)}</p>`;
        });

        // 测试 zAugment 的格式化方法
        output.innerHTML += '<h2>zAugment 格式化方法（剩余时间）：</h2>';
        const formatExpiryDate_v2 = (dateString) => {
            if (!dateString) return "未知";

            try {
                const now = new Date();
                const expiry = new Date(dateString);

                const diffMs = expiry.getTime() - now.getTime();

                if (diffMs <= 0) {
                    return "已过期";
                }

                const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

                return `${days}天${hours.toString().padStart(2, "0")}时${minutes.toString().padStart(2, "0")}分`;
            } catch {
                return dateString;
            }
        };

        testCases.forEach(dateStr => {
            output.innerHTML += `<p>${dateStr} → ${formatExpiryDate_v2(dateStr)}</p>`;
        });
    </script>
</body>
</html>

